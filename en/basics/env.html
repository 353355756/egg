<!DOCTYPE html>
<html lang="en">
<head>
  <title>Runtime Environment - Born to build better enterprise frameworks and apps</title>
<meta charset="utf-8">
<meta name="description" content="Born to build better enterprise frameworks and apps">
<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="icon" href="/images/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/css/index.css">

</head>
<body>
  <div id="container">
    <div class="nav">
  <header>
    <a href="/" class="nav-logo" alt="egg"><img src="/images/logo.svg"></a>
    <ul>
      <li><a href="/intro/" alt="Guide">Guide</a></li><li><a href="https://eggjs.org/badgeboard/" alt="Plugins">Plugins</a></li><li><a href="/release/" alt="Release">Release</a></li>
      <li><iframe src="https://ghbtns.com/github-btn.html?user=eggjs&repo=egg&type=star&count=false" frameborder="0" scrolling="0" width="54px" height="20px"></iframe></li>
    </ul>
  </header>
</div>

    <div class="page-title">
  <h1>GUIDE</h1>
  <h2>The best way to know egg</h2>
</div>

<div class="page-main">
  <article class="markdown-body">
    <h1>Runtime Environment</h1>
    <h1 id="runtime-environment"><a class="markdown-anchor" href="#runtime-environment">#</a> Runtime Environment</h1>
<p>There could be all kinds of difference during various stages of a web application development, but the application itself should be stateless, so EGG provide environment variables to cope with such difference.</p>
<p>EGG framework provides a variable named <code>env</code> for setting up the runtime environment. The <code>env</code> could be used to determine which configuration file should be applied, or you can perform any operations by detecting the <code>env</code> directly.</p>
<h2 id="how-to-configure-runtime-environment"><a class="markdown-anchor" href="#how-to-configure-runtime-environment">#</a> How to Configure Runtime Environment</h2>
<p>There are several ways:</p>
<ol>
<li>Use <code>config/env</code> file, usually we use the build tools to generate this file.</li>
<li>Specify the <code>EGG_SERVER_ENV</code> environment variable.</li>
</ol>
<p><code>EGG_SERVER_ENV</code> will be more commonly used, defining the environment variable when you start the application is the simplest way, for example, use the code below to start the application in the production environment.</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">EGG_SERVER_ENV=prod npm start</div></pre></td></tr></table></figure></p>
<h2 id="how-to-use"><a class="markdown-anchor" href="#how-to-use">#</a> How to Use</h2>
<p>You can use <code>app.config.env</code> to get the environment variable.
You can also load different configuration file for different environment by adding a file like  <code>config/config.{env}.js</code> with specified configs, please refer to  <a href="./config.html">config</a> for details.</p>
<h2 id="difference-with-node_env"><a class="markdown-anchor" href="#difference-with-node_env">#</a> Difference with NODE_ENV</h2>
<p>Lots of node applications use <code>NODE_ENV</code> for environment setting, but <code>EGG_SERVER_ENV</code>  distinguishes the environments much more specific. Generally speaking, there are local environment, unit test environment, test environment, production environment during the application development. Test and production environment are <strong>Server Environment</strong> and their <code>NODE_ENV</code> should be set to <code>production</code> , just like how npm make use of <code>NODE_ENV</code>. when you depoly applications in test and production environment, you don't install the devDependencies, so <code>production</code> should be applied.</p>
<p>Default mapping of EGG_SERVER_ENV and NODE_ENV</p>
<table>
<thead>
<tr>
<th>EGG_SERVER_ENV</th>
<th>NODE_ENV</th>
<th>remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td>local</td>
<td></td>
<td>local development environment</td>
</tr>
<tr>
<td>unittest</td>
<td>test</td>
<td>unit test environment</td>
</tr>
<tr>
<td>test</td>
<td>production</td>
<td>test environment on server</td>
</tr>
<tr>
<td>prod</td>
<td>production</td>
<td>production environment</td>
</tr>
</tbody>
</table>
<h2 id="difference-with-koa"><a class="markdown-anchor" href="#difference-with-koa">#</a> Difference with Koa</h2>
<p>We are using <code>app.env</code> to distinguishes the environments in koa, and <code>app.env</code> defualt to <code>process.env.NODE_ENV</code>. But in egg (and frameworks base on egg), we put all the configurations in <code>app.config</code>, so we should use <code>app.config.env</code> to distinguishes the environments, <code>app.env</code> is no logger used.</p>

  </article>
  <aside id="mobileAside" class="toc">
    <a id="mobileTrigger" href="#" class="mobile-trigger">
      <ul>
        <li></li>
        <li></li>
        <li></li>
      </ul>
    </a>
    <div class="mobile-menu">
      <ul><li><a href="/intro/" alt="Guide">Guide</a></li><li><a href="https://eggjs.org/badgeboard/" alt="Plugins">Plugins</a></li><li><a href="/release/" alt="Release">Release</a></li></ul>
    </div>
    <dl><dt>新手指南</dt><dd><ul><li><a href="/en/intro/index.html">egg 是什么?</a></li><li><a href="/en/intro/egg-and-koa.html">egg 和 koa</a></li><li><a href="/en/intro/quickstart.html">快速入门</a></li></ul></dd><dt>基础功能</dt><dd><ul><li><a href="/en/basics/env.html">运行环境</a></li><li><a href="/en/basics/config.html">配置</a></li><li><a href="/en/basics/middleware.html">中间件</a></li><li><a href="/en/basics/router.html">Router</a></li><li><a href="/en/basics/controller.html">Controller</a></li><li><a href="/en/basics/service.html">Service</a></li><li><a href="/en/basics/schedule.html">定时任务</a></li><li><a href="/en/basics/extend.html">框架扩展</a></li><li><a href="/en/basics/app-start.html">启动自定义</a></li></ul></dd><dt>核心功能</dt><dd><ul><li><a href="/en/core/development.html">本地开发</a></li><li><a href="/en/core/security.html">安全</a></li><li><a href="/en/core/httpclient.html">HttpClient</a></li><li><a href="/en/core/logger.html">日志</a></li><li><a href="/en/core/error-handling.html">异常处理</a></li><li><a href="/en/core/i18n.html">国际化</a></li><li><a href="/en/core/view.html">模板渲染</a></li><li><a href="/en/core/unittest.html">单元测试</a></li></ul></dd><dt>教程</dt><dd><ul><li><a href="/en/tutorials/mysql.html">MySQL</a></li><li><a href="/en/tutorials/restful.html">RESTful API</a></li><li><a href="/en/tutorials/progressive.html">渐进式开发</a></li></ul></dd><dt>进阶</dt><dd><ul><li><a href="/en/advanced/loader.html">Loader</a></li><li><a href="/en/advanced/plugin.html">插件开发</a></li><li><a href="/en/advanced/framework.html">框架开发</a></li><li><a href="/en/advanced/cluster.html">多进程模型</a></li><li><a href="/en/advanced/view-plugin.html">模板插件开发规范</a></li></ul></dd><dt>社区</dt><dd><ul><li><a href="/en/contributing.html">如何贡献</a></li></ul></dd></dl>
  </aside>
</div>

<script>
var mobileTrigger = document.getElementById('mobileTrigger');
var mobileAside = document.getElementById('mobileAside');
mobileTrigger.onclick = function(e) {
  if (mobileAside.className.indexOf('mobile-show') === -1) {
    mobileAside.className += ' mobile-show';
  } else {
    mobileAside.className = 'toc';
  }
};
</script>

    <div class="footer">
  <footer>
    <ul><li><a href="/intro/" alt="Guide">Guide</a></li><li><a href="https://eggjs.org/badgeboard/" alt="Plugins">Plugins</a></li><li><a href="/release/" alt="Release">Release</a></li></ul>
    <div class="license">Released under the MIT License <a href="https://github.com/eggjs"><img src="/images/github.svg"/></a></div>
  </footer>
</div>

  </div>
</body>
</html>
